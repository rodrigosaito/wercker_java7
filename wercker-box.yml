name: java7
version: 0.1.0
inherits: ruudk/ubuntu14.04@1.0.0
type: main
platform: ubuntu@14.04
description: Wercker box for Java development with mysql-client and fabric for deployment
packages:
  - oracle-java7
  - mysql-client
  - fabric
script: |-
  # Add webupd8 team repository that contains the 3 major oracle-java versions
  sudo add-apt-repository ppa:webupd8team/java -y
  sudo apt-get update

  # Accept the oracle license
  echo debconf shared/accepted-oracle-license-v1-1 select true | sudo debconf-set-selections
  echo debconf shared/accepted-oracle-license-v1-1 seen true |  sudo debconf-set-selections
  
  # Install oracle-java7
  sudo apt-get install oracle-java7-installer -y -qq
  
  # We should have java again
  type java || { echo "I expected java to be available after oracle-java7-installer installation. Aborting."; exit 1; }

  # Install maven
  wget -O $WERCKER_CACHE_DIR/maven.tgz http://www.us.apache.org/dist/maven/maven-3/3.2.1/binaries/apache-maven-3.2.1-bin.tar.gz
  cd /opt && sudo tar xzvf $WERCKER_CACHE_DIR/maven.tgz && sudo ln -s apache-maven-* maven
  sudo ln -s /opt/maven/bin/mvn /usr/bin/mvn
  
  type mvn || { echo "I expected maven to be available. Aborting."; exit 1; }

  # Install mysql-client
  sudo apt-get install mysql-client -y -qq

  type mysql || { echo "I expected mysql client to be available. Aborting."; exit 1; }

  # Install fabric
  sudo apt-get install fabric -y -qq

  type fab || { echo "I expected fab to be available. Aborting."; exit 1; }

